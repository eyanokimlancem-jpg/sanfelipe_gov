<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Municipality of San Felipe | Dashboard</title>

<script src="https://cdn.tailwindcss.com"></script>

<script>
tailwind.config = {
  theme: {
    extend: {
      colors: {
        primary: "#b91c1c",
        dark: "#7f1d1d",
      },
    },
  },
};
</script>

<style>
.office-card {
  backdrop-filter: blur(14px);
  background: rgba(255,255,255,0.95);
  border: 1px solid rgba(185,28,28,0.2);
  border-radius: 1.5rem;
  padding: 2rem;
  box-shadow: 0 10px 25px rgba(0,0,0,0.08);
  transition: transform 0.3s ease, box-shadow 0.3s ease;
}
.office-card:hover {
  transform: translateY(-6px);
  box-shadow: 0 15px 35px rgba(0,0,0,0.12);
}
</style>

</head>

<!-- LOGOUT CONFIRM MODAL -->
<div
  id="logoutModal"
  class="fixed inset-0 z-[999] hidden items-center justify-center
         bg-black/50 backdrop-blur-sm"
>

  <div
    id="logoutModalBox"
    class="bg-white rounded-2xl shadow-xl w-full max-w-md p-6
           transform scale-95 opacity-0 transition-all duration-200"
  >
    <h2 class="text-xl font-bold text-gray-800 mb-2">
      Confirm Logout
    </h2>
    <p class="text-gray-600 mb-6">
      Are you sure you want to log out?
    </p>

    <div class="flex justify-end gap-3">
      <button
        onclick="closeLogoutModal()"
        class="px-4 py-2 rounded-lg border border-gray-300
               hover:bg-gray-100 transition"
      >
        Cancel
      </button>

      <button
        onclick="confirmLogout()"
        class="px-4 py-2 rounded-lg bg-primary text-white
               hover:bg-dark transition"
      >
        Logout
      </button>
    </div>
  </div>
</div>


<body class="bg-gray-100 text-gray-900">

<!-- NAVBAR -->
<header class="fixed top-0 left-0 w-full z-40 bg-primary shadow-lg">
  <!-- TOP BAR -->
  <div class="relative flex items-center px-6 py-4">

    <!-- LOGO + TEXT -->
    <div
      class="flex items-center gap-3 text-white font-bold text-lg
             mx-auto md:mx-0"
    >
      <img
        src="assets/logo.png"
        alt="Logo"
        class="w-10 h-10 rounded-full"
      />
      <span class="whitespace-nowrap">
        Municipality of San Felipe
      </span>
    </div>

    <!-- MOBILE MENU BUTTON -->
    <button
      onclick="toggleMenu()"
      class="md:hidden text-white text-2xl absolute right-6"
      aria-label="Menu"
    >
      ☰
    </button>

    <!-- DESKTOP NAV -->
    <nav
      class="hidden md:flex ml-auto gap-6 text-white font-medium items-center"
    >
      <a href="#adminDatabase" id="databaseLink" class="hidden hover:text-red-200">
        Database
      </a>

      <a href="#hero" class="hover:text-red-200">Home</a>

      <div class="relative group">
        <button class="hover:text-red-200">About ▾</button>
        <div
          class="absolute hidden group-hover:block bg-white text-gray-800
                 rounded-xl shadow-lg mt-3 w-64"
        >
          <a href="#citizen-charter" class="block px-5 py-3 hover:bg-gray-100">
            Citizen Charter
          </a>
          <a href="#mission-vision" class="block px-5 py-3 hover:bg-gray-100">
            Mission & Vision
          </a>
          <a href="#awards" class="block px-5 py-3 hover:bg-gray-100">
            Awards & Recognition
          </a>
        </div>
      </div>

      <a href="#offices" class="hover:text-red-200">Offices</a>

      <input
        type="text"
        id="searchInput"
        placeholder="Search officials or offices..."
        class="w-72 px-4 py-2 rounded-lg text-sm text-gray-900 focus:outline-none"
      />

      <!-- LOGOUT -->
      <button
        id="logoutBtn"
        title="Logout"
        onclick="openLogoutModal()"
        class="ml-4 flex items-center text-white transition-all duration-300
               hover:text-red-200 hover:translate-x-1 group"
      >
        <svg xmlns="http://www.w3.org/2000/svg"
             class="w-6 h-6 transition-transform duration-300 group-hover:translate-x-1"
             fill="none" viewBox="0 0 24 24"
             stroke="currentColor" stroke-width="2">
          <path stroke-linecap="round" stroke-linejoin="round"
            d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a2 2 0 01-2 2H5a2 2 0 01-2-2V7a2 2 0 012-2h6a2 2 0 012 2v1"/>
        </svg>
      </button>
    </nav>
  </div>

  <!-- MOBILE MENU -->
  <div
    id="mobileMenu"
    class="hidden md:hidden bg-primary text-white px-6 pb-6
           space-y-4 border-t border-white/20"
  >
    <!-- SEARCH -->
    <input
      type="text"
      id="searchInputMobile"
      placeholder="Search..."
      class="w-full px-4 py-2 rounded-lg text-sm text-gray-900"
    />

    <!-- LINKS -->
    <a href="#hero" onclick="toggleMenu()" class="block">Home</a>
    <a href="#citizen-charter" onclick="toggleMenu()" class="block">Citizen Charter</a>
    <a href="#mission-vision" onclick="toggleMenu()" class="block">Mission & Vision</a>
    <a href="#awards" onclick="toggleMenu()" class="block">Awards</a>
    <a href="#offices" onclick="toggleMenu()" class="block">Offices</a>

    <a
      href="#adminDatabase"
      id="databaseLinkMobile"
      onclick="toggleMenu()"
      class="hidden block"
    >
      Database
    </a>

    <!-- LOGOUT -->
    <button
      onclick="openLogoutModal()"
      class="w-full flex items-center gap-2 border-t border-white/30
             pt-4 hover:text-red-200 transition"
    >
      <svg xmlns="http://www.w3.org/2000/svg"
           class="w-5 h-5"
           fill="none" viewBox="0 0 24 24"
           stroke="currentColor" stroke-width="2">
        <path stroke-linecap="round" stroke-linejoin="round"
          d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a2 2 0 01-2 2H5a2 2 0 01-2-2V7a2 2 0 012-2h6a2 2 0 012 2v1"/>
      </svg>
      Logout
    </button>
  </div>
</header>

<!-- HERO SECTION -->
<section id="hero" class="pt-32 pb-20 bg-gradient-to-r from-primary via-red-700 to-dark relative overflow-hidden">
  <div class="absolute inset-0 opacity-20 bg-[radial-gradient(circle_at_top_left,white,transparent_60%)]"></div>

  <div class="relative max-w-7xl mx-auto grid grid-cols-1 md:grid-cols-2 gap-12 px-6 items-center animate-fadeUp">

    <!-- LEFT -->
    <div class="flex justify-center">
      <img src="assets/logo.png" alt="Municipality of San Felipe"
           class="w-64 md:w-80 drop-shadow-2xl" />
    </div>

    <!-- RIGHT -->
    <div class="text-white space-y-6">
      <h1 class="text-4xl md:text-5xl font-extrabold leading-tight">
        Welcome to the <span class="text-red-200">San Felipe Portal, <span id="userName" class="text-red-200"></span></span>
      </h1>

    <p id="userRole" class="text-lg opacity-90"></p>

      <p class="non-admin max-w-xl opacity-95">
        A unified digital gateway providing fast, transparent, and reliable
        public services for the citizens of San Felipe.
      </p><br><br>

      <a href= "summary.html" class="non-admin mt-4 bg-white text-primary font-bold px-8 py-3 rounded-lg hover:bg-red-100 transition shadow-lg">
        View Municipality Summary
    </a>


    </div>

  </div>
</section>

<!-- ADMIN DATABASE SECTION -->
<section id="adminDatabase" class="hidden py-20 bg-gray-100">
  <div class="max-w-5xl mx-auto px-6">
  <h2 class="text-4xl font-extrabold text-center mb-12 text-primary">
    User Database
  </h2>

  <div class="grid md:grid-cols-1 gap-10 justify-center">

  <!-- STAFF -->
  <div class="bg-white rounded-2xl shadow-lg p-6">
    <h3 class="text-xl font-bold text-primary mb-4">Staff</h3>
    <ul id="staffList" class="space-y-2 text-sm"></ul>
  </div>

  <!-- CITIZENS -->
  <div class="bg-white rounded-2xl shadow-lg p-6">
    <h3 class="text-xl font-bold text-primary mb-4">Citizens</h3>
    <ul id="citizenList" class="space-y-2 text-sm"></ul>
  </div>

</div>

</section>

<!-- CITIZEN CHARTER -->
<section id="citizen-charter" class="non-admin bg-gray-50 searchable">
  <br>
  <h2 class="text-4xl font-extrabold mb-6 text-center">Citizen Charter</h2>
  <p class="text-center text-gray-700 max-w-4xl mx-auto">
    A commitment of the Municipality of San Felipe to deliver fast, transparent,
    accountable, and quality public service to every San Felipenean.
  </p>
</section>

<!-- MISSION & VISION -->
<section id="mission-vision" class="non-admin bg-white searchable"><br><br><br>
  <div class="max-w-6xl mx-auto grid md:grid-cols-2 gap-12 px-6">
    <div>
      <h3 class="text-3xl font-bold text-primary mb-4">Mission</h3>
      <p class="text-gray-700">
        To have a transparent, dedicated, concerned and consultative leadership
        that will efficiently implement plans and programs for SAN FELIPENEANS
        as well as to maintain a just, prosperous, healthy, peaceful and
        environment-friendly community.
      </p>
    </div>
    <div>
      <h3 class="text-3xl font-bold text-primary mb-4">Vision</h3>
      <p class="text-gray-700">
        We envision San Felipe as the business hub, environment model and premiere
        center of Zambales for agriculture, meat processing and tourism, towards
        a community of God-loving, caring, healthy, united, disciplined,
        well-informed, hospitable, prosperous and proud citizenry.
      </p>
    </div>
  </div>
</section>

<!-- AWARDS -->
<section id="awards" class="non-admin bg-gray-50 searchable"><br><br><br><br>
  <h2 class="text-4xl font-extrabold text-center mb-10">Awards & Recognition</h2>
  <ul class="grid md:grid-cols-2 gap-4 max-w-6xl mx-auto px-6 list-disc list-inside">
    <li>ISO 9001:2015 Certified Awardee</li>
    <li>2018 Seal of Good Local Governance Awardee</li>
    <li>Top 19 Finalist – Galing Pook Awards</li>
    <li>2016 Seal of Good Local Governance Awardee</li>
    <li>Hall of Famer for Clean and Green Award</li>
    <li>Most Outstanding Local Legislative Body</li>
  </ul>
</section>

<!-- MAYOR -->
<section id="mayor" class="non-admin bg-white text-center searchable"><br><br><br><br>
  <h2 class="text-4xl font-extrabold mb-8">About the Mayor</h2>
  <img src="assets/mayor.jpg" alt="Mayor of San Felipe" class="w-98 mx-auto rounded-2xl shadow-lg mb-6" />
  <h3 class="text-2xl font-bold">ENGR. REINHARD E. JERESANO</h3>
  <p class="mt-4 text-gray-700 max-w-3xl mx-auto">
    A dedicated public servant committed to transparent governance,
    sustainable development, and inclusive leadership.
  </p>
</section>

<!-- OFFICIALS -->
<section id="officials" class="non-admin bg-gray-50 searchable"><br><br><br><br>
  <h2 class="text-4xl font-extrabold mb-8 text-center">Elected Officials</h2>
  <div class="max-w-4xl mx-auto px-6">
    <p><strong>Vice Mayor:</strong> Mary Ann R. Quiba</p>
    <ul class="list-disc list-inside mt-6 text-gray-700">
      <li><strong>Councilor:</strong> Robert Torres</li>
      <li><strong>Councilor:</strong> Jethro De Jesus</li>
      <li><strong>Councilor:</strong> Ray Frondarina</li>
      <li><strong>Councilor:</strong> Sir Alfred Abille</li>
      <li><strong>Councilor:</strong> Gary Farinas</li>
      <li><strong>Councilor:</strong> Rex Asutilla</li>
      <li><strong>Councilor:</strong> Rosellyn Manglicmot</li>
      <li><strong>Councilor:</strong> Ramil Ablian</li>
    </ul>
    <p class="mt-4"><strong>SK Federation President:</strong> Iverson Alcantara</p>
  </div>
</section>

<!-- OFFICES -->
<section id="offices" class="non-admin bg-white searchable"><br><br><br><br>
  <div class="max-w-7xl mx-auto px-6">
    <h2 class="text-4xl font-extrabold text-center mb-12">Municipal Offices</h2>
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-10">

      <div class="office-card searchable">
        <h3 class="font-bold text-lg text-primary mb-2">Office of the Mayor</h3>
        <p>Oversees overall administration and municipal programs.</p>
      </div>

      <div class="office-card searchable">
        <h3 class="font-bold text-lg text-primary mb-2">Office of the Treasurer</h3>
        <p>Manages municipal funds and financial accountability.</p>
      </div>

      <div class="office-card searchable">
        <h3 class="font-bold text-lg text-primary mb-2">
          Municipal Disaster Risk Reduction and Management Office
        </h3>
        <p>Leads disaster preparedness, response, and recovery.</p>
      </div>

      <div class="office-card searchable">
        <h3 class="font-bold text-lg text-primary mb-2">Municipal Tourism Office</h3>
        <p>Promotes tourism development and cultural heritage.</p>
      </div>

      <div class="office-card searchable">
        <h3 class="font-bold text-lg text-primary mb-2">Office of the Local Civil Registry</h3>
        <p>Handles civil registration services.</p>
      </div>

      <div class="office-card searchable">
        <h3 class="font-bold text-lg text-primary mb-2">Rural Health Unit</h3>
        <p>Provides primary healthcare services.</p>
      </div>

    </div>
  </div><br><br><br>
</section>

<!-- FOOTER -->
<footer class="bg-primary text-white py-6 text-center">
  © 2026 Municipality of San Felipe
</footer>

<!-- SCRIPTS -->
<script>
  function toggleMenu() {
    const menu = document.getElementById("mobileMenu");
      menu.classList.toggle("hidden");
}


  function filterContent(value) {
    document.querySelectorAll(".searchable").forEach(item => {
      item.style.display = item.innerText.toLowerCase().includes(value)
        ? "block"
        : "none";
    });
  }

  document.getElementById("searchInput")
    ?.addEventListener("keyup", function () {
      filterContent(this.value.toLowerCase());
    });

  document.getElementById("searchInputMobile")
    ?.addEventListener("keyup", function () {
      filterContent(this.value.toLowerCase());
    });

 const currentUser = JSON.parse(localStorage.getItem("currentUser"));
const users = JSON.parse(localStorage.getItem("users")) || [];

if (!currentUser) {
  window.location.href = "index.html";
}

// Show user info
document.getElementById("userName").textContent = currentUser.firstName;
document.getElementById("userRole").textContent = `Logged In As: ${currentUser.role}`;

if (currentUser.role === "Admin") {

  document.querySelectorAll(".non-admin").forEach(el => el.style.display = "none");
  document.getElementById("adminDatabase").classList.remove("hidden");
  document.getElementById("databaseLink").classList.remove("hidden");
  document.getElementById("databaseLinkMobile").classList.remove("hidden");

  document.querySelectorAll('a[href="#hero"], a[href="#offices"]').forEach(el => el.style.display = "none");
  document.getElementById("searchInput")?.classList.add("hidden");
  document.getElementById("searchInputMobile")?.classList.add("hidden");


  const staffList = document.getElementById("staffList");
  const citizenList = document.getElementById("citizenList");
  const adminList = document.getElementById("adminList");

  // Render users with approve/delete controls
users.forEach((user, index) => {
  // Create wrapper li
  const li = document.createElement("li");
  li.className = "border rounded-xl bg-gray-50 shadow-sm hover:shadow-md transition overflow-hidden";

  // Summary (always visible)
  li.innerHTML = `
    <button class="w-full text-left flex justify-between items-center px-4 py-3 hover:bg-gray-100 transition group">
      <span class="font-semibold text-gray-800">
        ${user.fullname}
        <span class="text-sm text-gray-500">(${user.role})</span>
      </span>
      <svg xmlns="http://www.w3.org/2000/svg"
           class="w-5 h-5 text-gray-500 transform transition-transform group-data-[open=true]:rotate-180"
           fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
        <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7" />
      </svg>
    </button>

    <div class="details px-5 pb-4 space-y-1 hidden border-t border-gray-200 bg-white/70">
      <p><strong>Username:</strong> ${user.username || "(none)"}</p>
      <p><strong>Email:</strong> ${user.email || "(none)"}</p>
      <p><strong>Status:</strong> ${
        user.role === "Staff"
          ? user.approved
            ? "Approved ✅"
            : "Pending ⏳"
          : "Auto-Approved ✅"
      }</p>
      <p class="text-xs text-gray-500"><strong>Joined:</strong> ${user.date || "N/A"}</p>

      <div class="flex gap-2 pt-2">
        ${
          user.role === "Staff" && !user.approved
            ? `<button onclick="approveStaff(${index})"
                class='bg-green-600 text-white text-xs px-3 py-1 rounded hover:bg-green-700 transition'>
                Approve
              </button>`
            : ""
        }
        <button onclick="deleteUser(${index})"
          class="bg-red-600 text-white text-xs px-3 py-1 rounded hover:bg-red-700 transition">
          Delete
        </button>
      </div>
    </div>
  `;

  // Append to the correct list
  if (user.role === "Staff") staffList.appendChild(li);
  else if (user.role === "Citizen") citizenList.appendChild(li);

  // Add collapsible behavior
  const button = li.querySelector("button");
  const details = li.querySelector(".details");

  button.addEventListener("click", () => {
    const isOpen = !details.classList.contains("hidden");
    document.querySelectorAll("#adminDatabase .details").forEach(el => el.classList.add("hidden"));
    if (!isOpen) details.classList.remove("hidden");
  });
});


} else {
  document.getElementById("adminDatabase").classList.add("hidden");
}

function approveStaff(index) {
  const users = JSON.parse(localStorage.getItem("users"));
  users[index].approved = true;
  localStorage.setItem("users", JSON.stringify(users));
  alert("Staff approved");
  location.reload();
}

function deleteUser(index) {
  const users = JSON.parse(localStorage.getItem("users")) || [];
  const user = users[index];
  if (!user) {
    alert("User not found.");
    return;
  }
  const confirmed = confirm(`Delete user "${user.fullname}" (${user.username || 'no-username'})? This action cannot be undone.`);
  if (!confirmed) return;

  // If deleting currently logged-in user, remove currentUser and redirect to index
  const currentUser = JSON.parse(localStorage.getItem("currentUser")) || {};
  const deletingCurrent = currentUser.username && user.username === currentUser.username;

  users.splice(index, 1);
  localStorage.setItem("users", JSON.stringify(users));

  if (deletingCurrent) {
    localStorage.removeItem("currentUser");
    alert("You deleted the logged-in account. Logging out...");
    window.location.href = "index.html";
    return;
  }

  alert("User deleted.");
  location.reload();
}


  function logout() {
    localStorage.removeItem("currentUser");
    window.location.href = "index.html";
  }

  function openLogoutModal() {
    const modal = document.getElementById("logoutModal");
    const box = document.getElementById("logoutModalBox");

    modal.classList.remove("hidden");
    modal.classList.add("flex");

    setTimeout(() => {
      box.classList.remove("scale-95", "opacity-0");
    }, 10);
  }

  function closeLogoutModal() {
    const modal = document.getElementById("logoutModal");
    const box = document.getElementById("logoutModalBox");

    box.classList.add("scale-95", "opacity-0");

    setTimeout(() => {
      modal.classList.add("hidden");
      modal.classList.remove("flex");
    }, 200);
  }

  function confirmLogout() {
    localStorage.removeItem("currentUser");
    window.location.href = "index.html";
  }

  // Close modal when clicking outside
  document.getElementById("logoutModal")?.addEventListener("click", (e) => {
    if (e.target.id === "logoutModal") closeLogoutModal();
  });

  

</script>


</body>
</html>

